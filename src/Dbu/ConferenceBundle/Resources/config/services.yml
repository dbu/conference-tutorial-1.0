parameters:

services:

    dbu_conference.controller.schedule:
        class: Dbu\ConferenceBundle\Controller\ScheduleController
        arguments:
            - @doctrine_phpcr.odm.document_manager
        calls:
            - [ setContainer, [ @service_container ] ]

    dbu_conference.twig.extension:
        class: Dbu\ConferenceBundle\Twig\Extension\ConferenceExtension
        arguments:
            - @router
            - %dbu_conference.speakers_path%
        tags:
            - { name: twig.extension }

    dbu_conference.security.presentation_voter:
        class: Dbu\ConferenceBundle\PublishWorkflow\Voter\PresentationVoter
        arguments:
            - @service_container
        tags:
            - { name: cmf_published_voter, priority: 10 }

    dbu_conference.block.recently_added:
        class: Dbu\ConferenceBundle\Block\RecentlyAddedBlockService
        arguments:
            - "acme_main.block.rss"
            - "@templating"
        calls:
            - [ setDocumentManager, [@doctrine_phpcr.odm.document_manager] ]
        tags:
            - {name: "sonata.block"}

    dbu_conference.admin.recently_added:
        class: Dbu\ConferenceBundle\Admin\RecentlyAddedBlockAdmin
        arguments:
            - ~
            - Dbu\ConferenceBundle\Document\RecentlyAddedBlock
            - SonataAdminBundle:CRUD
        calls:
            - [ setRouteBuilder, [ @sonata.admin.route.path_info_slashes ] ]
            - [ setRootPath, [ %cmf_block.persistence.phpcr.block_basepath% ] ]
        tags:
            - { name: sonata.admin, manager_type: doctrine_phpcr, group: dashboard.group_content, label_catalogue: "DbuConferenceBundle", label: "Recently Added Block", label_translator_strategy: sonata.admin.label.strategy.underscore }

    dbu_conference.admin.room:
        class: Dbu\ConferenceBundle\Admin\RoomAdmin
        arguments:
            - ~
            - Dbu\ConferenceBundle\Document\Room
            - SonataAdminBundle:CRUD
        calls:
            - [ setRouteBuilder, [ @sonata.admin.route.path_info_slashes ] ]
            - [ setRootPath, [ %dbu_conference.rooms_path% ] ]
        tags:
            - { name: sonata.admin, manager_type: doctrine_phpcr, group: dashboard.group_content, label_catalogue: "DbuConferenceBundle", label: "Rooms", label_translator_strategy: sonata.admin.label.strategy.underscore }

    dbu_conference.admin.speaker:
        class: Dbu\ConferenceBundle\Admin\SpeakerAdmin
        arguments:
            - ~
            - Dbu\ConferenceBundle\Document\Speaker
            - SonataAdminBundle:CRUD
        calls:
            - [ setRouteBuilder, [ @sonata.admin.route.path_info_slashes ] ]
            - [ setRootPath, [ %dbu_conference.speakers_path% ] ]
        tags:
            - { name: sonata.admin, manager_type: doctrine_phpcr, group: dashboard.group_content, label_catalogue: "DbuConferenceBundle", label: "Speakers", label_translator_strategy: sonata.admin.label.strategy.underscore }

    dbu_conference.admin.presentation:
        class: Dbu\ConferenceBundle\Admin\PresentationAdmin
        arguments:
            - ~
            - Dbu\ConferenceBundle\Document\Presentation
            - SonataAdminBundle:CRUD
        calls:
            - [ setRouteBuilder, [ @sonata.admin.route.path_info_slashes ] ]
            - [ setRootPath, [ %dbu_conference.rooms_path% ] ]
        tags:
            - { name: sonata.admin, manager_type: doctrine_phpcr, group: dashboard.group_content, label_catalogue: "DbuConferenceBundle", label: "Presentations", label_translator_strategy: sonata.admin.label.strategy.underscore }
